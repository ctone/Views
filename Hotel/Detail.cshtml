@using System.Configuration
@using System.Web.UI.WebControls
@using DiethelmTSWebsite2015.Models
@using DiethelmTSWebsite2015.Core
@using DiethelmWebServiceClient.TSWS;

@{
	ViewBag.Title = "Detail";
	Layout = "~/Views/Shared/_LayoutWeb.cshtml";
	var search = ViewBag.Search as HotelSearchCondition;
	int id = Convert.ToInt32(ViewBag.ServiceID);

	ServiceInformationResponse hotelInfo = new ServiceInformationResponse();
	PriceAndAvailabilityService tsHotel = new PriceAndAvailabilityService();
	List<string> imageList = new List<string>();
	List<RoomTypeOption> roomTypeOptionList = new List<RoomTypeOption>();
	List<ServiceTypeRatingDetails> themes = new List<ServiceTypeRatingDetails>();
	List<ServiceTypeRatingDetails> languages = new List<ServiceTypeRatingDetails>();
	List<GetServiceAllocationDetailsResponse> serviceAllocation = new List<GetServiceAllocationDetailsResponse>();
	ServiceRuleData serviceRule = new ServiceRuleData();
	List<RoomTypes> occInfo = new List<RoomTypes>();
	List<string> hints = new List<string>();
	Hotel hotel = new Hotel();
	string cancellation;

	roomTypeOptionList = ViewBag.RoomTypeOptionList;
	hotelInfo = ViewBag.HotelInfo;
	tsHotel = ViewBag.TSHotel;
	imageList = ViewBag.ImageList;
	themes = ViewBag.Themes;
	languages = ViewBag.Languages;
	serviceAllocation = ViewBag.ServiceAllocation;
	serviceRule = ViewBag.ServiceRule;
	cancellation = ViewBag.Cancellation;
	hotel = ViewBag.HotelDB;
	occInfo = ViewBag.RoomTypeList;
	DateTime checkInDate = ViewBag.Search.CheckInDate;
	DateTime checkOutDate = ViewBag.Search.CheckOutDate;
	DateTime next = checkInDate.AddMonths(1);
	TimeSpan? night = checkOutDate - checkInDate;
	roomTypeOptionList = roomTypeOptionList.OrderBy(t => t.NetAmount).ToList();
	hints = ViewBag.Hints;
	string currencyCode = ViewBag.Currency;

	//var roomTypeGroup = roomTypeOptionList.GroupBy(t => t.Occupancy).ToList();

	bool IsDisplayHint = hints.Count() > 0;
}
<script type="text/javascript" >
    function DisplayCalendar(month, year, showresult, roomtypeID, serviceID) {
        $.ajax({
            url: '@Url.Action("Calendar", "Hotel")',
            data: { month: month, year: year, serviceID: serviceID, roomtypeID: roomtypeID },
            type: 'Get',
            success: function (data) {
                $(showresult).html(data);
            }
        });
    }

</script>
<input type="hidden" id="hddMonth" value="@checkInDate.Month" />
<input type="hidden" id="hddYear" value="@checkInDate.Year" />
<input type="hidden" id="hddNextMonth" value="@next.Month" />
<input type="hidden" id="hddNextYear" value="@next.Year" />

<div class="row step-title">
    <div class="small-12 medium-4 columns">
        <h3 class="step-title-label">Search Hotel</h3>
    </div>
    <div class="small-12 medium-8 columns progress-bar">
        <img src="~/Images/progress_s2.png" />
    </div>
</div>

@using (Html.BeginForm("Traveller", "Booking", FormMethod.Post, new { id = "frm" }))
{
    
    <input type="hidden" id="HotelName" value="@hotelInfo.ServiceName" />
    <input type="hidden" id="CheckInDate" value="@checkInDate" />
    <input type="hidden" id="CheckOutDate" value="@checkOutDate" />
       
    
    <div class="row hotel-detail">
        <div class="column small-12">

            <div class="row hotel-detail">
                <div class="column small-10 detail-title">
                    @hotelInfo.ServiceName
                    <br>
                    @if (ViewBag.StarRating >= 5)
					{
                        <img src="~/Images/5-star.png">
					}
					else
					{ 
                        <img src="~/Images/@ViewBag.StarRating-star.png">
					}
                    |
                    @if (themes.Count > 0)
					{
						foreach (var theme in themes)
						{
							if (theme.ServiceTypeRatingName.Trim().ToLower() == "boutique")
							{
                                <img src="/Images/boutique.png" alt="@theme.ServiceTypeRatingName.Trim()" title="@theme.ServiceTypeRatingName.Trim()" />
							}
							if (theme.ServiceTypeRatingName.Trim().ToLower() == "beachfront")
							{
                                <img src="/Images/beachfront.png" alt="@theme.ServiceTypeRatingName.Trim()" title="@theme.ServiceTypeRatingName.Trim()" />
							}
							if (theme.ServiceTypeRatingName.Trim().ToLower() == "environmentally friendly")
							{
                                <img src="/Images/environmentally.png" alt="@theme.ServiceTypeRatingName.Trim()" title="@theme.ServiceTypeRatingName.Trim()" />
							}
							if (theme.ServiceTypeRatingName.Trim().ToLower() == "family friendly")
							{
                                <img src="/Images/family.png" alt="@theme.ServiceTypeRatingName.Trim()" title="@theme.ServiceTypeRatingName.Trim()" />
							}
							if (theme.ServiceTypeRatingName.Trim().ToLower() == "diethelm preferred")
							{
                                <img src="/Images/preferred.png" alt="@theme.ServiceTypeRatingName.Trim()" title="@theme.ServiceTypeRatingName.Trim()" />
							}
							if (theme.ServiceTypeRatingName.Trim().ToLower() == "beach access/ close to the beach")
							{
                                <img src="/Images/beachaccess.png" alt="@theme.ServiceTypeRatingName.Trim()" title="@theme.ServiceTypeRatingName.Trim()" />
							}
							if (theme.ServiceTypeRatingName.Trim().ToLower() == "honeymoon")
							{
                                <img src="/Images/honeymoon.png" alt="@theme.ServiceTypeRatingName.Trim()" title="@theme.ServiceTypeRatingName.Trim()" />
							}
							if (theme.ServiceTypeRatingName.Trim().ToLower() == "villas")
							{
                                <img src="/Images/villas.png" alt="@theme.ServiceTypeRatingName.Trim()" title="@theme.ServiceTypeRatingName.Trim()" />
							}
							if (theme.ServiceTypeRatingName.Trim().ToLower() == "awesome deal")
							{
                                <img src="/Images/awesomedeal.png" alt="@theme.ServiceTypeRatingName.Trim()" title="@theme.ServiceTypeRatingName.Trim()" />
							}
						}
					}

                </div>
                <div class="row ">
                    <div class="small-12 columns post-breadcumb">
                        <a onclick="history.back();" class="right">< Back</a>
                    </div>
                </div>
            </div>

        </div>
    </div>


    <div class="row">
        <div class="column small-12 medium-9 owl-theme-area detail-slide-img-cover">
            <div id="slice-content-hotel" class=" owl-carousel owl-theme">
                @if (imageList != null)
				{
					foreach (var image in imageList)
					{
                        <div class="item">
                            <img src="@image" title="@hotelInfo.ServiceName" alt="@hotelInfo.ServiceName" /><br />
                        </div>
					}
				}
            </div>
        </div>
        <div class="column small-12 medium-3 map-area  ">
            <div class="row">
                <div class="column small-12  no-padding-right">
                    <div id="googleMap" style="width: 100%; min-height: 225px;"></div>
                </div>
                <div class="column small-12">
                    <div class="hotel-address" style="margin-right: -8px;">
                        <div class="font-red">@hotelInfo.ServiceName </div>
                        Address: @hotelInfo.AddressLine1 @hotelInfo.AddressLine2 @hotelInfo.AddressLine3 @hotelInfo.AddressLine4 @hotelInfo.AddressPostCode @hotelInfo.AddressCity
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="page-title page-title-package">
        <div class="row">
            <div class="column small-12">
                <img src="/Images/yellow-arrow.png" />
                Please Select
            </div>
        </div>
    </div>

    <div class="gray-bg">
        <div class="row">
            <div class="column small-12">
                <div class="hotel-detail-section"></div>
            </div>
            <div class="column small-12 medium-3">
                <label class="hotel-detail-label">Please select your preferred room</label>
            </div>
            <div class="column small-12 medium-9" style="padding-top: 15px; padding-left: 10px;">
                @if (roomTypeOptionList != null && roomTypeOptionList.Count() > 0)
				{
					int count = 0;
					int firstServiceID = 0;//เอาไปใช้ load service extra ในครั้งแรก

					///MY SAMPLE
					var sampleData = from t in roomTypeOptionList
									 join o in occInfo
										on t.Occupancy equals o.RoomTypeID
									 select new { t.Occupancy, t.ID, t.ServiceID, t.Name, t.Status, t.NetAmount, t.MealPlan, t.Rules, t.Description, t.Image, o.MaxAdultCapacity, o.MaxChildCapacity };

					int tempKey = -1;
					int tempServiceId = -1;
					<div class="row roomtypelabel-box">
						<div class="columns small-12 roomtypelabel">
							<a onclick="MoreOptionClick('single')" id="MoreOptionShow_single">+ Show single room</a>
							<a onclick="MoreOptionClick('single')" id="MoreOptionHide_single" style="display:none;">- Hide single room</a>
						</div>
					</div>
					<div class="MoreOption_single" style="display:none;">
					@foreach (var data in sampleData.Where(s => s.Occupancy == 1))
	 {
		 if (tempKey != data.Occupancy)
		 {
			 tempKey = data.Occupancy;
                            <input type="hidden" name="@string.Format("[{0}].OccupancyTypeID", count)" value="@tempKey" />
		 }

		 string namePattern = data.ID + "_" + data.ServiceID;

                        <div id="g_@namePattern" class="please-select CtnGroup">
                            <input type="hidden" name="RoomOccupancy" value="@data.Occupancy" />
                            <input type="hidden" name="RoomTypeID" value="@data.ID" />
                            <input type="hidden" name="ServiceID" value="@data.ServiceID" />
                            <div class="row">
                                <div class="column small-12 large-5 hotel-serviceName">
                                    &bull; @data.Name
                                </div>

                                <div class="column small-12 large-3 display-block">
                                    @if (data.Status == "ON REQUEST")
									{
                                    <img src="/Images/OnRequest.png" class="float-right hotel-serviceStatus" />
									}
									else
									{
                                    <img src="/Images/status.png" class="float-right hotel-serviceStatus" />
									}
                                    <div id="cap_@namePattern" class="float-right">

                                    </div>
                                </div>
                                <div class="show-for-small" style="clear: both"></div>
                                <div class="column small-6 large-2 text-right">
                                    <div>Price per night</div>
                                </div>
                                <div class="column small-6 large-2 text-right">
                                    <div class="right hotel-servicePrice">@currencyCode @data.NetAmount.ToString("#,###.#0")</div>
                                </div>
                                <div style="clear: both"></div>
                            </div>
                            <div class="row">
                                <div class="column small-12">
                                    <div class="dashed-line"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="column medium-1 hide-for-small">
                                    &nbsp;
                                </div>
                                <div class="column small-12 large-11">
                                    <text class="hotel-servicePrice">Meal:</text>  @Html.Raw(Utility.StripEndBrTag(data.MealPlan)) <br />
                                    <text class="hotel-servicePrice">Cancellation:</text> @Html.Raw(Utility.StripEndBrTag(cancellation)) <br />
                                    <text class="MoreOption_@namePattern" style="display:none;">
                                        <text class="hotel-servicePrice">Rules:</text> @Html.Raw(Utility.StripEndBrTag(data.Rules)) <br />
                                        <text class="hotel-servicePrice">Room Description:</text> @Html.Raw(Utility.StripEndBrTag(data.Description)) <br />
                                        <div class="right-content">
                                            @if (data.Image != "")
											{
                                                <img src="@data.Image" width="300" height="200" />
											}
                                            <div class="dashed-line"></div>
                                            <div class="hotel-servicePrice">Room Avaliable</div>
                                            <div class="calendar-title"><    Available only display for 1 month after entered checkin date    ></div>
                                            <div style="display: block;">
                                                <div style="float:left;width:300px;margin-right:10px;" id="cal1_@namePattern">
                                                    <script type="text/javascript">
                                                        DisplayCalendar('@checkInDate.Month', '@checkInDate.Year', '#cal1_@namePattern', '@data.ID', '@data.ServiceID');
                                                    </script>
                                                </div>
                                                <div class="show-for-small" style="clear: both"></div>
                                                <div style="float:left;width:300px;" id="cal2_@namePattern">
                                                    <script type="text/javascript">
                                                        DisplayCalendar('@next.Month', '@next.Year', '#cal2_@namePattern', '@data.ID', '@data.ServiceID');
                                                    </script>
                                                </div>
                                                <div class="show-for-small" style="clear: both"></div>
                                                <div style="float: left;">
                                                    <img src="/Images/calendar-label.png" width="100" />
                                                </div>
                                            </div>
                                            <div style="clear: both"></div>
                                            <div style="display: block;">
                                                <div class="calendar-footer">Check in : <span class="font-red">@checkInDate.ToString("dd-MMM-yyyy")</span></div>
                                                <div class="calendar-footer">Check out : <span class="font-red">@checkOutDate.ToString("dd-MMM-yyyy")</span></div>
                                                <div class="calendar-footer">Night : <span class="font-red">@night.Value.Days</span></div>
                                            </div>
                                            <div class="dashed-line"></div>
                                        </div>
                                    </text>
                                    <div class="columns small-12">
                                        <a onclick="MoreOptionClick('@namePattern')" class="showmore" id="MoreOptionShow_@namePattern">+ Show more</a>
                                        <a onclick="MoreOptionClick('@namePattern')" class="showless" id="MoreOptionHide_@namePattern" style="display:none;">- Show less</a>
                                    </div>
                                    <div class="column small-12">
                                        <div class="dashed-line"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="column hide-for-small medium-1">&nbsp;</div>
                                <div class="column small-12 medium-3">
                                    <label class="search-label">Room(s)</label>
                                    <select id="ddr_@namePattern" data-parentid="g_@namePattern" name="RoomAmount" class="RoomAmount" data-serviceid="@data.ServiceID" data-optionid="@data.ID" data-occupancyid="@data.Occupancy" data-maxchildcap="@data.MaxChildCapacity" data-maxadultcap="@data.MaxAdultCapacity" onchange="changeRoom('@data.ServiceID','@data.ID', '@data.Occupancy', '@data.MaxAdultCapacity', '@data.MaxChildCapacity')">
                                        <option value="0">0 Room</option>
                                        <option value="1">1 Room</option>
                                        <option value="2">2 Rooms</option>
                                        <option value="3">3 Rooms</option>
                                        <option value="4">4 Rooms</option>
                                        <option value="5">5 Rooms</option>
                                    </select>
                                </div>
                                <div id="ctn_@namePattern" class="column small-12 medium-4">
                                    &nbsp;
                                </div>
                                <div class="column small-6 medium-2 text-right hotel-total-label">
                                    Total
                                </div>
                                <div id="price_@namePattern" class="column small-6 medium-2  text-right hotel-servicePriceRed">
                                    @currencyCode 0
                                </div>
                                <input type="hidden" id="hddPrice_@namePattern" class="RoomTypePrice" value="0" />
                            </div>
                        </div>
					 }
					</div>
					<div class="row roomtypelabel-box">
						<div class="columns small-12 roomtypelabel">
							<a onclick="MoreOptionClick('double')" id="MoreOptionShow_double">+ Show double room</a>
							<a onclick="MoreOptionClick('double')" id="MoreOptionHide_double" style="display:none;">- Hide double room</a>
						</div>
                    </div>
					<div class="MoreOption_double" style="display:none;">
					@foreach (var data in sampleData.Where(s => s.Occupancy == 3))
					 {
						 if (tempKey != data.Occupancy)
						 {
							 tempKey = data.Occupancy;
                            <input type="hidden" name="@string.Format("[{0}].OccupancyTypeID", count)" value="@tempKey" />
						 }

						 string namePattern = data.ID + "_" + data.ServiceID;

                        <div id="g_@namePattern" class="please-select CtnGroup">
                            <input type="hidden" name="RoomOccupancy" value="@data.Occupancy" />
                            <input type="hidden" name="RoomTypeID" value="@data.ID" />
                            <input type="hidden" name="ServiceID" value="@data.ServiceID" />
                            <div class="row">
                                <div class="column small-12 large-5 hotel-serviceName">
                                    &bull; @data.Name
                                </div>

                                <div class="column small-12 large-3 display-block">
                                    @if (data.Status == "ON REQUEST")
									{
                                    <img src="/Images/OnRequest.png" class="float-right hotel-serviceStatus" />
									}
									else
									{
                                    <img src="/Images/status.png" class="float-right hotel-serviceStatus" />
									}
                                    <div id="cap_@namePattern" class="float-right">

                                    </div>
                                </div>
                                <div class="show-for-small" style="clear: both"></div>
                                <div class="column small-6 large-2 text-right">
                                    <div>Price per night</div>
                                </div>
                                <div class="column small-6 large-2 text-right">
                                    <div class="right hotel-servicePrice">@currencyCode @data.NetAmount.ToString("#,###.#0")</div>
                                </div>
                                <div style="clear: both"></div>
                            </div>
                            <div class="row">
                                <div class="column small-12">
                                    <div class="dashed-line"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="column medium-1 hide-for-small">
                                    &nbsp;
                                </div>
                                <div class="column small-12 large-11">
                                    <text class="hotel-servicePrice">Meal:</text>  @Html.Raw(Utility.StripEndBrTag(data.MealPlan)) <br />
                                    <text class="hotel-servicePrice">Cancellation:</text> @Html.Raw(Utility.StripEndBrTag(cancellation)) <br />
                                    <text class="MoreOption_@namePattern" style="display:none;">
                                        <text class="hotel-servicePrice">Rules:</text> @Html.Raw(Utility.StripEndBrTag(data.Rules)) <br />
                                        <text class="hotel-servicePrice">Room Description:</text> @Html.Raw(Utility.StripEndBrTag(data.Description)) <br />
                                        <div class="right-content">
                                            @if (data.Image != "")
											{
                                                <img src="@data.Image" width="300" height="200" />
											}
                                            <div class="dashed-line"></div>
                                            <div class="hotel-servicePrice">Room Avaliable</div>
                                            <div class="calendar-title"><    Available only display for 1 month after entered checkin date    ></div>
                                            <div style="display: block;">
                                                <div style="float:left;width:300px;margin-right:10px;" id="cal1_@namePattern">
                                                    <script type="text/javascript">
                                                    	DisplayCalendar('@checkInDate.Month', '@checkInDate.Year', '#cal1_@namePattern', '@data.ID', '@data.ServiceID');
                                                    </script>
                                                </div>
                                                <div class="show-for-small" style="clear: both"></div>
                                                <div style="float:left;width:300px;" id="cal2_@namePattern">
                                                    <script type="text/javascript">
                                                    	DisplayCalendar('@next.Month', '@next.Year', '#cal2_@namePattern', '@data.ID', '@data.ServiceID');
                                                    </script>
                                                </div>
                                                <div class="show-for-small" style="clear: both"></div>
                                                <div style="float: left;">
                                                    <img src="/Images/calendar-label.png" width="100" />
                                                </div>
                                            </div>
                                            <div style="clear: both"></div>
                                            <div style="display: block;">
                                                <div class="calendar-footer">Check in : <span class="font-red">@checkInDate.ToString("dd-MMM-yyyy")</span></div>
                                                <div class="calendar-footer">Check out : <span class="font-red">@checkOutDate.ToString("dd-MMM-yyyy")</span></div>
                                                <div class="calendar-footer">Night : <span class="font-red">@night.Value.Days</span></div>
                                            </div>
                                            <div class="dashed-line"></div>
                                        </div>
                                    </text>
                                    <div class="columns small-12">
                                        <a onclick="MoreOptionClick('@namePattern')" class="showmore" id="MoreOptionShow_@namePattern">+ Show more</a>
                                        <a onclick="MoreOptionClick('@namePattern')" class="showless" id="MoreOptionHide_@namePattern" style="display:none;">- Show less</a>
                                    </div>
                                    <div class="column small-12">
                                        <div class="dashed-line"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="column hide-for-small medium-1">&nbsp;</div>
                                <div class="column small-12 medium-3">
                                    <label class="search-label">Room(s)</label>
                                    <select id="ddr_@namePattern" data-parentid="g_@namePattern" name="RoomAmount" class="RoomAmount" data-serviceid="@data.ServiceID" data-optionid="@data.ID" data-occupancyid="@data.Occupancy" data-maxchildcap="@data.MaxChildCapacity" data-maxadultcap="@data.MaxAdultCapacity" onchange="changeRoom('@data.ServiceID','@data.ID', '@data.Occupancy', '@data.MaxAdultCapacity', '@data.MaxChildCapacity')">
                                        <option value="0">0 Room</option>
                                        <option value="1">1 Room</option>
                                        <option value="2">2 Rooms</option>
                                        <option value="3">3 Rooms</option>
                                        <option value="4">4 Rooms</option>
                                        <option value="5">5 Rooms</option>
                                    </select>
                                </div>
                                <div id="ctn_@namePattern" class="column small-12 medium-4">
                                    &nbsp;
                                </div>
                                <div class="column small-6 medium-2 text-right hotel-total-label">
                                    Total
                                </div>
                                <div id="price_@namePattern" class="column small-6 medium-2  text-right hotel-servicePriceRed">
                                    @currencyCode 0
                                </div>
                                <input type="hidden" id="hddPrice_@namePattern" class="RoomTypePrice" value="0" />
                            </div>
                        </div>
					 }
					</div>
					<div class="row roomtypelabel-box">
						<div class="columns small-12 roomtypelabel">
							<a onclick="MoreOptionClick('triple')" id="MoreOptionShow_triple">+ Show triple room</a>
							<a onclick="MoreOptionClick('triple')" id="MoreOptionHide_triple" style="display:none;">- Hide triple room</a>
						</div>
                    </div>
					<div class="MoreOption_triple" style="display:none;">
					@foreach (var data in sampleData.Where(s => s.Occupancy == 4))
					 {
						 if (tempKey != data.Occupancy)
						 {
							 tempKey = data.Occupancy;
											<input type="hidden" name="@string.Format("[{0}].OccupancyTypeID", count)" value="@tempKey" />
						 }

						 string namePattern = data.ID + "_" + data.ServiceID;

                        <div id="g_@namePattern" class="please-select CtnGroup">
                            <input type="hidden" name="RoomOccupancy" value="@data.Occupancy" />
                            <input type="hidden" name="RoomTypeID" value="@data.ID" />
                            <input type="hidden" name="ServiceID" value="@data.ServiceID" />
                            <div class="row">
                                <div class="column small-12 large-5 hotel-serviceName">
                                    &bull; @data.Name
                                </div>

                                <div class="column small-12 large-3 display-block">
                                    @if (data.Status == "ON REQUEST")
									{
                                    <img src="/Images/OnRequest.png" class="float-right hotel-serviceStatus" />
									}
									else
									{
                                    <img src="/Images/status.png" class="float-right hotel-serviceStatus" />
									}
                                    <div id="cap_@namePattern" class="float-right">

                                    </div>
                                </div>
                                <div class="show-for-small" style="clear: both"></div>
                                <div class="column small-6 large-2 text-right">
                                    <div>Price per night</div>
                                </div>
                                <div class="column small-6 large-2 text-right">
                                    <div class="right hotel-servicePrice">@currencyCode @data.NetAmount.ToString("#,###.#0")</div>
                                </div>
                                <div style="clear: both"></div>
                            </div>
                            <div class="row">
                                <div class="column small-12">
                                    <div class="dashed-line"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="column medium-1 hide-for-small">
                                    &nbsp;
                                </div>
                                <div class="column small-12 large-11">
                                    <text class="hotel-servicePrice">Meal:</text>  @Html.Raw(Utility.StripEndBrTag(data.MealPlan)) <br />
                                    <text class="hotel-servicePrice">Cancellation:</text> @Html.Raw(Utility.StripEndBrTag(cancellation)) <br />
                                    <text class="MoreOption_@namePattern" style="display:none;">
                                        <text class="hotel-servicePrice">Rules:</text> @Html.Raw(Utility.StripEndBrTag(data.Rules)) <br />
                                        <text class="hotel-servicePrice">Room Description:</text> @Html.Raw(Utility.StripEndBrTag(data.Description)) <br />
                                        <div class="right-content">
                                            @if (data.Image != "")
											{
                                                <img src="@data.Image" width="300" height="200" />
											}
                                            <div class="dashed-line"></div>
                                            <div class="hotel-servicePrice">Room Avaliable</div>
                                            <div class="calendar-title"><    Available only display for 1 month after entered checkin date    ></div>
                                            <div style="display: block;">
                                                <div style="float:left;width:300px;margin-right:10px;" id="cal1_@namePattern">
                                                    <script type="text/javascript">
                                                    	DisplayCalendar('@checkInDate.Month', '@checkInDate.Year', '#cal1_@namePattern', '@data.ID', '@data.ServiceID');
                                                    </script>
                                                </div>
                                                <div class="show-for-small" style="clear: both"></div>
                                                <div style="float:left;width:300px;" id="cal2_@namePattern">
                                                    <script type="text/javascript">
                                                    	DisplayCalendar('@next.Month', '@next.Year', '#cal2_@namePattern', '@data.ID', '@data.ServiceID');
                                                    </script>
                                                </div>
                                                <div class="show-for-small" style="clear: both"></div>
                                                <div style="float: left;">
                                                    <img src="/Images/calendar-label.png" width="100" />
                                                </div>
                                            </div>
                                            <div style="clear: both"></div>
                                            <div style="display: block;">
                                                <div class="calendar-footer">Check in : <span class="font-red">@checkInDate.ToString("dd-MMM-yyyy")</span></div>
                                                <div class="calendar-footer">Check out : <span class="font-red">@checkOutDate.ToString("dd-MMM-yyyy")</span></div>
                                                <div class="calendar-footer">Night : <span class="font-red">@night.Value.Days</span></div>
                                            </div>
                                            <div class="dashed-line"></div>
                                        </div>
                                    </text>
                                    <div class="columns small-12">
                                        <a onclick="MoreOptionClick('@namePattern')" class="showmore" id="MoreOptionShow_@namePattern">+ Show more</a>
                                        <a onclick="MoreOptionClick('@namePattern')" class="showless" id="MoreOptionHide_@namePattern" style="display:none;">- Show less</a>
                                    </div>
                                    <div class="column small-12">
                                        <div class="dashed-line"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="column hide-for-small medium-1">&nbsp;</div>
                                <div class="column small-12 medium-3">
                                    <label class="search-label">Room(s)</label>
                                    <select id="ddr_@namePattern" data-parentid="g_@namePattern" name="RoomAmount" class="RoomAmount" data-serviceid="@data.ServiceID" data-optionid="@data.ID" data-occupancyid="@data.Occupancy" data-maxchildcap="@data.MaxChildCapacity" data-maxadultcap="@data.MaxAdultCapacity" onchange="changeRoom('@data.ServiceID','@data.ID', '@data.Occupancy', '@data.MaxAdultCapacity', '@data.MaxChildCapacity')">
                                        <option value="0">0 Room</option>
                                        <option value="1">1 Room</option>
                                        <option value="2">2 Rooms</option>
                                        <option value="3">3 Rooms</option>
                                        <option value="4">4 Rooms</option>
                                        <option value="5">5 Rooms</option>
                                    </select>
                                </div>
                                <div id="ctn_@namePattern" class="column small-12 medium-4">
                                    &nbsp;
                                </div>
                                <div class="column small-6 medium-2 text-right hotel-total-label">
                                    Total
                                </div>
                                <div id="price_@namePattern" class="column small-6 medium-2  text-right hotel-servicePriceRed">
                                    @currencyCode 0
                                </div>
                                <input type="hidden" id="hddPrice_@namePattern" class="RoomTypePrice" value="0" />
                            </div>
                        </div>
	 }
					</div>
@*
            foreach (var group in roomTypeGroup)
            {
                var roomTypeList = roomTypeOptionList.Where(t => t.Occupancy == group.Key).ToList();

                //Occupancy: @Html.Raw(group.Key)
                var last = roomTypeList.Last();

            <input type="hidden" name="@string.Format("[{0}].OccupancyTypeID", count)" value="@group.Key" />
                foreach (var roomType in roomTypeList)
                {
                    string namePattern = roomType.ID + "_" + roomType.ServiceID;
                    string isCheck = "";
                    int roomID = Convert.ToInt32(roomType.ID);
                    var occ = occInfo.Where(t => t.RoomTypeID == group.Key).FirstOrDefault();

                    if (roomType == roomTypeList.First())
                    {
                        firstServiceID = roomType.ServiceID;
                    }

                    if (roomType == roomTypeList.First())
                    {
                        isCheck = "checked='checked'";
                    }
            <div id="g_@namePattern" class="please-select CtnGroup">
                <input type="hidden" name="RoomOccupancy" value="@group.Key" />
                <input type="hidden" name="RoomTypeID" value="@roomType.ID" />
                <input type="hidden" name="ServiceID" value="@roomType.ServiceID" />

                <div class="row">
                    <div class="column small-12 large-5 hotel-serviceName">
                        &bull; @roomType.Name
                    </div>
                    <div class="column small-12 large-3 display-block">

                        @if (roomType.Status == "ON REQUEST")
                        {
                            <img src="/Images/OnRequest.png" class="float-right hotel-serviceStatus" />
                        }
                        else
                        {
                            <img src="/Images/status.png" class="float-right hotel-serviceStatus" />
                        }
                        <div id="cap_@namePattern" class="float-right">

                        </div>
                    </div>
                    <div class="show-for-small" style="clear: both"></div>
                    <div class="column small-6 large-2 text-right">
                        <div >Price per night</div>
                    </div>
                    <div class="column small-6 large-2 text-right">
                        <div class="right hotel-servicePrice">@currencyCode @roomType.NetAmount.ToString("#,###.#0")</div>
                    </div>
                    <div style="clear: both"></div>
                </div>
                    <div class="row">
                        <div class="column small-12">
                            <div class="dashed-line"></div>
                        </div>
                    </div>
                <div class="row">
                    <div class="column medium-1 hide-for-small">
                        &nbsp;
                    </div>
                    <div class="column small-12 large-11">
                        <text class="hotel-servicePrice">Meal:</text>  @Html.Raw(Utility.StripEndBrTag(roomType.MealPlan)) <br />
                        <text class="hotel-servicePrice">Cancellation:</text> @Html.Raw(Utility.StripEndBrTag(cancellation)) <br />
                        <text class="MoreOption_@namePattern" style="display:none;">
                            <text class="hotel-servicePrice">Rules:</text> @Html.Raw(Utility.StripEndBrTag(roomType.Rules)) <br />
                            <text class="hotel-servicePrice">Room Description:</text> @Html.Raw(Utility.StripEndBrTag(roomType.Description)) <br />
                            <div class="right-content">
                                @if (roomType.Image != "")
                                {
                                    <img src="@roomType.Image" width="300" height="200" />
                                }
                                <div class="dashed-line"></div>
                                <div class="hotel-servicePrice">Room Avaliable</div>
                                <div class="calendar-title"><    Available only display for 1 month after entered checkin date    ></div>
                                <div style="display: block;">
                                    <div style="float:left;width:300px;margin-right:10px;" id="cal1_@namePattern">
                                        <script type="text/javascript">
                                            DisplayCalendar('@checkInDate.Month', '@checkInDate.Year', '#cal1_@namePattern', '@roomType.ID', '@roomType.ServiceID');
                                        </script>
                                    </div>
                                    <div class="show-for-small" style="clear: both"></div>
                                    <div style="float:left;width:300px;" id="cal2_@namePattern">
                                        <script type="text/javascript">
                                            DisplayCalendar('@next.Month', '@next.Year', '#cal2_@namePattern', '@roomType.ID', '@roomType.ServiceID');
                                        </script>
                                    </div>
                                    <div class="show-for-small" style="clear: both"></div>
                                    <div style="float: left;">
                                        <img src="/Images/calendar-label.png" width="100" />
                                    </div>
                                </div>
                                <div style="clear: both"></div>
                                <div style="display: block;">
                                    <div class="calendar-footer">Check in : <span class="font-red">@checkInDate.ToString("dd-MMM-yyyy")</span></div>
                                    <div class="calendar-footer">Check out : <span class="font-red">@checkOutDate.ToString("dd-MMM-yyyy")</span></div>
                                    <div class="calendar-footer">Night : <span class="font-red">@night.Value.Days</span></div>
                                </div>
                                <div class="dashed-line"></div>
                            </div>


                        </text>
                        <div class="columns small-12">
                            <a onclick="MoreOptionClick('@namePattern')" class="showmore" id="MoreOptionShow_@namePattern">+ Show more</a>
                            <a onclick="MoreOptionClick('@namePattern')" class="showless" id="MoreOptionHide_@namePattern" style="display:none;">- Show less</a>
                        </div>
                        <div class="column small-12">
                            <div class="dashed-line"></div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="column small-1">&nbsp;</div>
                    <div class="column small-3">
                        <label class="search-label">Room(s)</label>
                        <select id="ddr_@namePattern" data-parentid="g_@namePattern" name="RoomAmount" class="RoomAmount" data-serviceid="@roomType.ServiceID" data-optionid="@roomType.ID" data-occupancyid="@group.Key" data-maxchildcap="@occ.MaxChildCapacity" data-maxadultcap="@occ.MaxAdultCapacity" onchange="changeRoom('@roomType.ServiceID','@roomType.ID', '@group.Key', '@occ.MaxAdultCapacity', '@occ.MaxChildCapacity')">
                            <option value="0">0 Room</option>
                            <option value="1">1 Room</option>
                            <option value="2">2 Rooms</option>
                            <option value="3">3 Rooms</option>
                            <option value="4">4 Rooms</option>
                            <option value="5">5 Rooms</option>
                        </select>
                    </div>
                    <div id="ctn_@namePattern" class="column small-4">
                        &nbsp;
                    </div>
                    <div class="column small-2 text-right hotel-total-label">
                        Total
                    </div>
                    <div id="price_@namePattern" class="column small-2  text-right hotel-servicePriceRed">
                         @currencyCode 0
                    </div>
                    <input type="hidden" id="hddPrice_@namePattern" class="RoomTypePrice" value="0" />
                </div>


            </div>
                }
                count++;
            }
                *@
				}

                <div class="row">
                    <div class="column small-12 medium-2 small-label" style="margin-top: 15px; margin-bottom: 10px;">
                        <div class="hotel-detail-label">Extra Service</div>
                    </div>
                    <div class="column small-12 medium-10  small-label">
                        <div class="serviceExtra font-gray margin-top15" data-first-service-id="" data-occupancy="">
                            
                        </div>
                    </div>
                </div>

                <div class="small-label">Total Price</div>
                <div class=" hotel-detail-text">
                    <div id="total" class="left detail-total-price">0</div>
                </div>

                <input type="button" id="btnSelect" value="Select" class="button right" onclick="ShowHints()" />

            </div>
        </div>
    </div>
    <div class="row">
        <div class="column small-12">
            <div class="hotel-detail-section"></div>
        </div>
        <div class="column small-12 medium-3">
            <label class="hotel-detail-label">Description</label>
        </div>
        <div class="column small-12 medium-9 hotel-detail-text ">
            <div class="hotel-detal-description">
                @hotelInfo.ServiceDescription<br />
                Check In: @hotel.CheckIn<br />
                Check Out: @hotel.CheckOut<br />
                Distance to airport: @hotel.DistanceToAirport Kms.<br />
                Nearest Airport: @hotel.NearestAirport<br />
            </div>
            <a class="readmore-link" id="read-more-description" onclick="ShowDescription();">Read more</a>
        </div>

    </div>
    <div class="row">
        <div class="column small-12">
            <div class="hotel-detail-section"></div>
        </div>
        <div class="column small-12 medium-3">
            <label class="hotel-detail-label">Promotion</label>
        </div>
        <div class="column small-12 medium-9 hotel-detail-text">
            @if (serviceRule != null && serviceRule.PromotionList != null && serviceRule.PromotionList.Count() > 0)
			{
				foreach (var item in serviceRule.PromotionList)
				{
                <span>@item.RuleMessage</span><br />
				}
			}
        </div>
    </div>
    <div class="row">
        <div class="column small-12">
            <div class="hotel-detail-section"></div>
        </div>
        <div class="column small-12 medium-3">
            <label class="hotel-detail-label">Hotel Facilities</label>
        </div>
        <div class="column small-12 medium-9 hotel-detail-text">
            <div class="hotel-detail-facility">
                @if (hotelInfo.ServiceFacilities != null && hotelInfo.ServiceFacilities.Count() > 0)
				{
					foreach (var item in hotelInfo.ServiceFacilities)
					{
                    <span>@item.ServiceTypeFacilityName</span><br />
					}
				}
            </div>
            <a class="readmore-link" id="read-more-facility" onclick="ShowFacility();">Read more</a>
        </div>
    </div>


    <div class="row">
        <div class="column small-12">
            <input type="button" value="< Back" class="button  btn-gray right " onclick="history.back();" />
        </div>
    </div>

    <div id="cloneTemplate">
        <div class="child-age columns small-6 left hide">
            <select name="ChildAge" class="childAge-amount">
                <option value="0">0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
            </select>
        </div>

            <div class="columns small-12   child-row hide">
                    <label class="search-label">Age</label>
                <div class="child-container row">
                </div>
            </div>

        <div class="room hide">
            <div class="room-selection">
                <div class="columns medium-6 small-6">
                    <label class="search-label">Adults</label>
                    <select name="Adults" class="adult-amount">
                        @*<option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>*@
                    </select>
                </div>
                <div class="columns medium-6 small-6">
                    <label class="search-label">Children</label>
                    <select name="Children" class="child-amount">
                        @*<option value="0">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>*@
                    </select>
                </div>
            </div>
        </div>
    </div>


}


<input type="hidden" id="latitude" value="@hotelInfo.Latitude">
<input type="hidden" id="longtitude" value="@hotelInfo.Longitude">

@section scripts
{
    <script src="@Url.Content("~/Scripts/TS/Hotel.js")"></script>

    <script src="http://maps.googleapis.com/maps/api/js"></script>
    <script>
        var latitude = $('#latitude').val();
        var longtitude = $('#longtitude').val();
        var myCenter = new google.maps.LatLng(latitude, longtitude);
        function initialize() {
            var mapProp = {
                center: myCenter,
                zoom: 14,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

            var map = new google.maps.Map(document.getElementById("googleMap"), mapProp);

            var marker = new google.maps.Marker({
                position: myCenter,
                icon: '/Images/red-marker-black-border-hi.png'
            });

            marker.setMap(map);
        }

        google.maps.event.addDomListener(window, 'load', initialize);

        $(document).on('change', 'select.child-amount', function () {
            var numberOfChildren = $(this).find('option:selected').val();
            var room = $(this).closest('.room');
            room.find('.child-row').remove();

            if (parseInt(numberOfChildren) == 0) {
                return;
            }

            var childRow = $('#cloneTemplate .child-row').first().clone();
            childRow.addChildAge(parseInt(numberOfChildren), $(this).attr("data-ServiceID"), $(this).attr("data-GroupID"), $(this).attr("data-RoomTypeID"), $(this).attr("data-OccupancyID"), $(this).attr("data-PriceID"));
            room.find('.room-selection').append(childRow);
            room.find('*').removeClass('hide');

            var parentID = $(this).attr('data-parentID');

        });

        $(document).ready(function () {
            $('#slice-content-hotel').each(function () {
                if ($(this).find('.item').length > 1) {
                    $(this).owlCarousel({
                        dots: true,
                        autoplaySpeed: 1000,
                        items: 1,
                        autoplay: true,
                        autoplayTimeout: 1000,
                        loop: true
                    })
                } else {
                    $(this).owlCarousel({
                        dots: true,
                        autoplaySpeed: 1000,
                        items: 1,
                        autoplay: true,
                        autoplayTimeout: 1000,
                        loop: false
                    })
                }
            });
            var i;
            var text = "";
            $("#frm").find(".RoomAmount").each(function (i) {
                //Gen html รูปตามจำนวน $(this).attr("data-MaxAdultCap") และ child
                var text = "";
                for (i = 0; i < $(this).attr("data-maxadultcap") ; i++) {
                    text += "<img src='/Images/adult.png' alt='Adult' title='Adult' />";
                }
                for (i = 0; i < $(this).attr("data-maxchildcap") ; i++) {
                    text += "<img src='/Images/child.png' alt='Child' title='Child' />";
                }
                $("#cap_" + $(this).attr("data-optionid") + "_" + $(this).attr("data-ServiceID")).html(text);
                //alert("#cap_" + $(this).attr("data-optionid") + "_" + $(this).attr("data-ServiceID"));
            });


        });
        function MoreOptionClick(id) {
            $('.MoreOption_'+id).toggle('slow');
            $('#MoreOptionShow_'+id).toggle();
            $('#MoreOptionHide_'+id).toggle();
        }
        $(document).on('change', 'select.child-amount', function () {


            var searchData = ConvertFormToJsonForGetPrice($('#frm'), $(this).attr("data-GroupID"), $(this).attr("data-ServiceID"), $(this).attr("data-RoomTypeID"), $(this).attr("data-OccupancyID"));
            var priceID = $(this).attr("data-PriceID");
            var hddPriceID = "hddPrice_" + $(this).attr("data-RoomTypeID") + "_" + $(this).attr("data-ServiceID");// hdd price ID

            $("#" + priceID).html("Loading..");

            $.ajax({
                url: '@Url.Action("GetPrice", "Hotel")',
                type: 'POST',
                data: searchData,
                contentType: "application/json",
                success: function (data) {
                    $("#" + priceID).html(data.PriceText + " " + data.Currency);
                    $("#" + hddPriceID).val(data.Price);
                    //GrandTotal();
                    GenerateExtraService($(this).attr("data-ServiceID"));
                }
            });

        });

            $(document).on('change', 'select.adult-amount', function () {
                GenerateExtraService($(this).attr("data-ServiceID"));
            });

            $(document).on('change', 'select.childAge-amount', function () {
                var searchData = ConvertFormToJsonForGetPrice($('#frm'), $(this).attr("data-GroupID"), $(this).attr("data-ServiceID"), $(this).attr("data-RoomTypeID"), $(this).attr("data-OccupancyID"));
                var priceID = $(this).attr("data-PriceID");
                var hddPriceID = "hddPrice_" + $(this).attr("data-RoomTypeID") + "_" + $(this).attr("data-ServiceID");// hdd price ID

                $("#" + priceID).html("Loading..");

                $.ajax({
                    url: '@Url.Action("GetPrice", "Hotel")',
                    type: 'POST',
                    data: searchData,
                    contentType: "application/json",
                    success: function (data) {
                        $("#" + priceID).html(data.PriceText + " " + data.Currency);
                        $("#" + hddPriceID).val(data.Price);
                        //GrandTotal();
                        GenerateExtraService($(this).attr("data-ServiceID"));
                    }
                });
            });



            function GenerateExtraService(serviceID) {

                var result = ConvertFormToJsonForBook($('#frm'));

                $(".serviceExtra").html("Service Extra Loading...");

                $.ajax({
                    url: '@Url.Action("GetExtraService", "Hotel")',
                    type: 'POST',
                    data: result,
                    contentType: "application/json",
                    success: function (data) {
                        $(".serviceExtra").html(data);
                        GrandTotal();
                    }
                });

            }

            function RemoveExtraService(serviceID) {

                var canDel = true;

                $("#frm").find(".RoomAmount").each(function (i) {
                    if ($(this).val() != "0" && $(this).attr("data-ServiceID") == serviceID) {
                        canDel = false;
                    }
                });

                if (canDel) {
                    $("#ex_" + serviceID).remove();
                }
            }


            var url = '@Url.Action("GetExtraService", "Hotel")';

            $(document).ready(function () {

            });


            function changeRoom(serviceID, RoomTypeID, occupancyID, maxAdult, maxChild) {
                var id = "ctn_" + RoomTypeID + "_" + serviceID;//containner ID
                var ddID = "ddr_" + RoomTypeID + "_" + serviceID;//dropdown ID
                var gID = "g_" + RoomTypeID + "_" + serviceID;// group ID
                var priceID = "price_" + RoomTypeID + "_" + serviceID;// price ID
                var hddPriceID = "hddPrice_" + RoomTypeID + "_" + serviceID;// hdd price ID
                var container = $('#' + id);
                container.clearRoom();

                var numberOfRoom = 0;
                try {
                    numberOfRoom = parseInt($('#' + ddID).val());
                } catch (e) {

                }

                //$("#nGuest").val(numberOfRoom);
                container.addNewRoom2(numberOfRoom, serviceID, maxAdult, maxChild, gID, RoomTypeID, occupancyID, priceID);

                var searchData = ConvertFormToJsonForGetPrice($('#frm'), gID, serviceID, RoomTypeID, occupancyID);

                $("#" + priceID).html("Loading..");

                $.ajax({
                    url: '@Url.Action("GetPrice", "Hotel")',
                    type: 'POST',
                    data: searchData,
                    contentType: "application/json",
                    success: function (data) {
                        $("#" + priceID).html(data.Currency + " " + data.PriceText);
                        $("#" + hddPriceID).val(data.Price);
                        GrandTotal();
                    }
                });


                //Load Extra
                if (numberOfRoom == 0) {
                    RemoveExtraService(serviceID);
                }

                GenerateExtraService(serviceID);

            }

            function ConvertFormToJsonForGetPrice(form, parentID, serviceID, RoomTypeID, occupancyID) {
                var result = {};
                //result.City = form.find('#' + parentID + ' select[name=City]').val();
                //result.CityArea = form.find('#' + parentID + ' select[name=CityArea]').val();
                result.HotelName = $("#HotelName").val();
                result.CheckInDate = $("#CheckInDate").val();
                result.CheckOutDate = $("#CheckOutDate").val();
                result.RoomAmount = form.find('#' + parentID + ' select[name=RoomAmount]').val();
                result.ServiceID = serviceID;
                result.RoomTypeID = RoomTypeID;

                //alert(parentID);

                var rooms = [];
                form.find('#' + parentID + ' .room').each(function (i) {

                    var room = {};
                    var adults = $(this).find('select[name=Adults] option:selected').val();
                    room.Adults = adults;
                    room.OccupancyID = occupancyID;
                    room.Children = [];


                    var childAges = $(this).find('.child-container .child-age');

                    childAges.each(function (j) {
                        var childAge = {};
                        var age = $(this).find('select[name=ChildAge] option:selected').val();
                        childAge.Age = age;
                        room.Children.push(childAge);
                    });

                    rooms.push(room);
                });

                result.Rooms = rooms;

                return JSON.stringify(result);
            }

            function ConvertFormToJsonForBook(form) {

                var result = {};
                //result.RoomAmount = form.find('#' + parentID + ' select[name=RoomAmount]').val();
                result.StartDate = $("#CheckInDate").val();
                result.EndDate = $("#CheckOutDate").val();

                var rooms = [];
                var extras = [];

                form.find('.CtnGroup').each(function (i) {
                    var parentID = $(this).attr("id");

                    var roomOccupancy = $(this).find('input[name=RoomOccupancy]').val();
                    var serviceID = $(this).find('input[name=ServiceID]').val();
                    var roomTypeID = $(this).find('input[name=RoomTypeID]').val();

                    form.find('#' + parentID + ' .room').each(function (j) {

                        var room = {};
                        var adults = $(this).find('select[name=Adults] option:selected').val();
                        room.OccupancyID = roomOccupancy;
                        room.ServiceID = serviceID;
                        room.RoomTypeID = roomTypeID;
                        room.Adults = adults;
                        room.Children = [];

                        var childAges = $(this).find('.child-container .child-age');

                        childAges.each(function (k) {
                            var childAge = {};
                            var age = $(this).find('select[name=ChildAge] option:selected').val();
                            childAge.Age = age;
                            room.Children.push(childAge);
                        });

                        rooms.push(room);
                    });

                });

                result.Rooms = rooms;


                $.each($("input[type='checkbox']:checked"), function (index, value) {
                    var extra = {};
                    extra.ServiceID = value.defaultValue.split("&")[2];
                    extra.ServiceExtraID = value.defaultValue.split("&")[0];
                    extras.push(extra);
                });

                result.Extras = extras;

                return JSON.stringify(result);
            }

            function currencyFormat(num) {
                return num.toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,")
            }

            function ShowHints() {
                var IsDisplayHint = true;

                @if (IsDisplayHint)
				{
                <text>IsDisplayHint = true;</text>
				}
				else
				{
                <text>IsDisplayHint = false;</text>
				}

                if (IsDisplayHint) {
                    $("#HintsPopup").foundation('reveal', 'open');
                }
                else {
                    Book();
                }
            }

            function CloseHints() {
                $("#HintsPopup").foundation('reveal', 'close');
            }

            function Book() {

                $('#Loading').foundation('reveal', 'open');

                var result = ConvertFormToJsonForBook($('#frm'));

                $.ajax({
                    url: '@Url.Action("SetDetailData", "Hotel")',
                    type: 'POST',
                    data: result,
                    contentType: "application/json",
                    success: function (data) {
                        $("#frm").submit();
                    }
                });
            }

            function ChangeOption(serviceID, OccupancyID) {
                $('.serviceExtra').each(function (i) {
                    var occupancyID = $(this).attr('data-occupancy');
                    if (OccupancyID == occupancyID) {
                        //LoadExtraService($(this), serviceID, occupancyID, url, i);
                        $.ajax({
                            url: url,
                            type: 'GET',
                            data: {
                                ServiceID: serviceID
                                , OccupancyID: occupancyID
                                , Index: i
                            },
                            success: function (data) {
                                $(this).html(data);
                                //var extraServicePrice = $("[name='extra-service-price']").val();

                                //Nop Remove
                                //GrandTotal();
                            }
                        });

                    }
                });
            }
            function GrandTotal() {
                //Nop Remove
                /*var roomPriceSum = 0;
                var extraServicePriceSum = 0;

                $.each($("input[type='radio']:checked"), function (index, value) {
                    roomPriceSum += Number(value.defaultValue.split("&")[2]);
                });
                $.each($("input[type='checkbox']:checked"), function (index, value) {
                    extraServicePriceSum += Number(value.defaultValue.split("&")[1]);
                });
                $("#total").html(currencyFormat(roomPriceSum + extraServicePriceSum) + " THB");*/

                //Nop Add New Logic
                var totalPrice = 0;
                $("#frm").find('.RoomTypePrice').each(function (i) {
                    totalPrice = totalPrice + Number($(this).val());

                });

                $.each($("input[type='checkbox']:checked"), function (index, value) {
                    totalPrice += Number(value.defaultValue.split("&")[1]);
                });

                $("#total").html(currencyFormat(totalPrice) + " @currencyCode");
            }

            function ShowDescription() {
                $(".hotel-detal-description").css("height", "100%");
                $("#read-more-description").hide();
            }
            function ShowFacility() {
                $(".hotel-detail-facility").css("height", "100%");
                $("#read-more-facility").hide();
            }

    </script>
}


@section popup
{
    <div id="HintsPopup" class="reveal-modal medium" data-reveal>

        <div class="row">
            <div class="column small-12">
                Hints
            </div>
        </div>
        <div class="row hotel-detail-text">
            @foreach (var item in hints)
			{
                <div class="column small-12 ">
                    @item
                </div>
			}
        </div>
        <div class="row ">
            <div class="column small-12 text-right">
                <input type="button" value="OK" class="button tiny" onclick="Book()" />
                <input type="button" value="Close" class="button tiny" onclick="CloseHints()" />
            </div>
        </div>
    </div>
}